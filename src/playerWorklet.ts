const worker = `var s;(function(u){u.state="state",u.buffer="buffer"})(s||(s={}));var a=class extends AudioWorkletProcessor{constructor(e){super(e);this.bindFns(),this.channels=Array(e?.outputChannelCount?.[0]??2).fill(void 0).map(()=>this.newChannelItem()),this.port.onmessage=n=>this.handleMessage(n),this.handlers={[s.state]:this.handleState,[s.buffer]:this.handleBuffer}}bindFns(){this.handleMessage=this.handleMessage.bind(this),this.handleState=this.handleState.bind(this),this.handleBuffer=this.handleBuffer.bind(this),this.process=this.process.bind(this),this.onEndProcess=this.onEndProcess.bind(this)}newChannelItem(){return{bufferCursor:0,currentBuffer:0,state:!1,totalBuffers:0}}handleMessage(e){this.handlers[e.data.type](e.data)}handleState(e){e.type===s.state&&(typeof e.state!="boolean"||typeof e.channel!="number"||!this.channels[e.channel]||(this.channels[e.channel].state=e.state))}bufferKey(e){let n=this.channels[e].totalBuffers;return this.channels[e].totalBuffers+=1,n}handleBuffer(e){if(e.type!==s.buffer||e.buffer?.buffer===void 0||typeof e.channel!="number"||!this.channels[e.channel])return;this.channels[e.channel].state||(this.channels[e.channel].state=!0);let n=this.bufferKey(e.channel);this.channels[e.channel][n]=e.buffer}onEndProcess(){for(let e=0;e<this.channels.length;e+=1)!this.channels[e].state&&this.channels[e].totalBuffers>0&&(this.channels[e]=this.newChannelItem())}process(e,n){let l=n[0],c=Math.min(this.channels.length,l.length);try{for(let r=0;r<c;r+=1){let f=l[r],t=this.channels[r];if(!t.state||!t.totalBuffers||!t[t.currentBuffer]){f.fill(0);continue}for(let h=0;h<f.length;h+=1){if(!t.state||!t.totalBuffers||!t[t.currentBuffer]){f.fill(0,h);break}f[h]=t[t.currentBuffer][t.bufferCursor];let i=!1;if(t.bufferCursor>t[t.currentBuffer].length-2e3&&t[t.currentBuffer+1]){let o=2e3-(t[t.currentBuffer].length-t.bufferCursor);f[h]+=t[t.currentBuffer+1][o],i=!0}t.bufferCursor+=1,t.bufferCursor===t[t.currentBuffer].length&&(delete t[t.currentBuffer],t.bufferCursor=i?2e3:0,t.currentBuffer+=1)}}this.onEndProcess()}catch(r){console.warn("Audio Worklet Errored:",r)}return!0}};registerProcessor("playerWorklet",a);`

export default worker