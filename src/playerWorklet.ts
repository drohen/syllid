const worker = `var t;(function(h){h.state="state",h.buffer="buffer"})(t||(t={}));var i=class extends AudioWorkletProcessor{constructor(n){super(n);this.bindFns(),this.channels=Array(n?.outputChannelCount?.[0]??2).fill(void 0).map(()=>this.newChannelItem()),this.port.onmessage=u=>this.handleMessage(u),this.handlers={[t.state]:this.handleState,[t.buffer]:this.handleBuffer}}bindFns(){this.handleMessage=this.handleMessage.bind(this),this.handleState=this.handleState.bind(this),this.handleBuffer=this.handleBuffer.bind(this),this.process=this.process.bind(this)}newChannelItem(){return{bufferCursor:0,currentBuffer:0,state:!1,totalBuffers:0}}handleMessage(n){this.handlers[n.data.type](n.data)}handleState(n){n.type===t.state&&(typeof n.state!="boolean"||typeof n.channel!="number"||!this.channels[n.channel]||(this.channels[n.channel].state=n.state))}handleBuffer(n){n.type===t.buffer&&(n.buffer?.buffer===void 0||typeof n.channel!="number"||!this.channels[n.channel]||(this.channels[n.channel].state||(this.channels[n.channel].state=!0),this.channels[n.channel][this.channels[n.channel].totalBuffers]=n.buffer,this.channels[n.channel].totalBuffers+=1))}process(n,u){let l=u[0],a=Math.min(this.channels.length,l.length);for(let r=0;r<a;r+=1){let s=l[r],e=this.channels[r];if(!e.state||!e.totalBuffers||!e[e.currentBuffer]){s.fill(0);continue}for(let f=0;f<s.length;f+=1){if(s[f]=e[e.currentBuffer][e.bufferCursor],e.bufferCursor>e[e.currentBuffer].length-2e3&&e[e.currentBuffer+1]){let c=2e3-(e[e.currentBuffer].length-e.bufferCursor);s[f]+=e[e.currentBuffer+1][c]}e.bufferCursor+=1,e.bufferCursor===e[e.currentBuffer].length&&(delete e[e.currentBuffer],e.bufferCursor=e[e.currentBuffer+1]!==void 0?2e3:0,e.currentBuffer+=1)}}return!0}};registerProcessor("playerWorklet",i);`

export default worker